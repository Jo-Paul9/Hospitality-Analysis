DAX Measure:
Below are the various data analysis expressions calculations on the report visualization.

Total Bookings: 
	= COUNT('fact_bookings'[booking_id])

Successful Bookings 
	= SUM(fact_aggregated_bookings[successful_bookings])

Total Guests 
	= SUM('fact_bookings'[no_guests])

Total No Show Bookings = 
    CALCULATE(
        [Total Bookings],
        'fact_bookings'[booking_status] = "No Show"
    )


DURN (Daily Utilized Room Nights)
= DIVIDE([Total Checked Out], [No of days])


DSRN (Daily Sellable Room Nights)
= DIVIDE([Total Capacity], [No of days])


DSRN WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([DSRN],dim_date[wn]= selv)
var revpw =  CALCULATE([DSRN],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


DBRN (Daily Booked Room Nights)
= DIVIDE([Total Bookings], [No of days])


Booking % by Platform = 
    DIVIDE([Total Bookings],
        CALCULATE([Total Bookings],
        ALL('fact_bookings'[booking_platform])))


Booking % by Room class = 
    DIVIDE([Total Bookings],
        CALCULATE([Total Bookings],
        ALL('dim_rooms'[room_class])))


No of days = 
    DATEDIFF(
        MIN(dim_date[date]),
        MAX(dim_date[date]),
        DAY) +1


Total Cancelled Bookings = 
    CALCULATE(
        [Total Bookings],
        'fact_bookings'[booking_status] = "Cancelled"
    )


Total Capacity 
	= SUM('fact_aggregated_bookings'[capacity])


Total Checked Out = 
    CALCULATE(
        [Total Bookings],
        'fact_bookings'[booking_status] = "Checked Out"
    )


Checked Out % 
	= DIVIDE([Total Checked Out], [Total Bookings],0)


Cancellation % 
	= DIVIDE([Total Cancelled Bookings], [Total Bookings],0)


Occupancy % = 
    DIVIDE([Successful Bookings], [Total Capacity],0)


Occupancy WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([Occupancy %],dim_date[wn]= selv)
var revpw =  CALCULATE([Occupancy %],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


Average Rating 
	= AVERAGE('fact_bookings'[ratings_given]) 


No Show rate % 
	= DIVIDE([Total No Show Bookings], [Total Bookings],0)


Non-Rating % 
	= DIVIDE([Non-Rating Count], [Total Bookings],0)


Non-Rating Count = [Total Bookings] - [Rating Count]


Rating % 
	= DIVIDE([Rating Count], [Total Bookings],0)


Rating Count = 
    CALCULATE(
        COUNTROWS('fact_bookings'),
        'fact_bookings'[ratings_given] > 0
    )


Rating Stars (Floor) = 
VAR _avg = [Average Rating]
VAR _full = INT( FLOOR( _avg, 1 ) )
VAR _clamped = MIN(5, MAX(0, _full))
RETURN
IF( ISBLANK(_avg), "No rating", REPT("‚≠ê", _clamped) )



Realisation % 
	= 1-([Cancellation %] + [No Show rate %])


Realisation WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([Realisation %],dim_date[wn]= selv)
var revpw =  CALCULATE([Realisation %],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


ADR 
= DIVIDE([Revenue], [Total Bookings],0)


ADR WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([ADR],dim_date[wn]= selv)
var revpw =  CALCULATE([ADR],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


Revenue 
= SUM('fact_bookings'[revenue_realized])


Revenue WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([Revenue],dim_date[wn]= selv)
var revpw =  CALCULATE([Revenue],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


RevPAR 
= DIVIDE([Revenue], [Total Capacity])


Revpar WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([RevPAR],dim_date[wn]= selv)
var revpw =  CALCULATE([RevPAR],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return


DIVIDE(revcw,revpw,0)-1


